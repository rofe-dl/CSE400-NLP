# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1MFa_KPBrlb_wEHXOKwq8lM4QVIURZ1gM
"""

import csv

from google.colab import drive
drive.mount('/content/gdrive')
directory = '/content/gdrive/MyDrive/Thesis/IEMOCAP/Session 1/transcriptions'
directory1 = '/content/gdrive/MyDrive/Thesis/IEMOCAP/Session 1/EmoEvaluation'

import os

emotions = []

final = []
transcripts = []

print("xxxxxx")
transcriptions = os.listdir(directory)
transcriptions.sort()

print("xxxxxx")
emoEvaluation = os.listdir(directory1)
emoEvaluation.sort()

print(transcriptions==emoEvaluation)

for filename1 in emoEvaluation:
  file_path = directory1 + "/" + filename1
  file = open(file_path, "r")
  lines = file.readlines()

  for line in lines:
    if line[0] == "[":
      emotions.append(line.split()[4])
  # print(emotions)

for filename in transcriptions: 
  m_list = []
  f_list = []   
  file_path = directory + "/" + filename
  file = open(file_path, "r")
  transcript_lines = file.readlines()
  for lines in transcript_lines:
    lines = lines.split(":")
    print(lines)
    if len(lines[0]) > 1:
      if lines[0][-24] == "F":
        f_list.append(lines[1][1:-1])
      elif lines[0][-24] == "M":
        m_list.append(lines[1][1:-1])
  transcripts += f_list + m_list


for i in range(len(transcripts)):
  final.append([transcripts[i], emotions[i]])
print(final)

fields = ["Sentence", "Emotion"]
rows = final 

with open("/content/gdrive/MyDrive/Thesis/IEMOCAP/data.csv", "w") as f: 
  write = csv.writer(f)
      
  write.writerow(fields)
  write.writerows(rows)